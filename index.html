<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Auguri Matteo! ðŸŽ“</title>
  <style>
    :root{
      --bg1:#06121a; --bg2:#0b2736; --card:#0c1a29;
      --accent1:#ff6b9f; --accent2:#5cc1ff; --accent3:#00d1a8;
      --muted:#a0b8c8; --text-main:#eaf6ff; --border:rgba(92, 193, 255, 0.1);
    }
    html,body{height:100%;margin:0;font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial}
    body{
      background: linear-gradient(180deg, var(--bg1) 0%, var(--bg2) 100%);
      display:flex;align-items:center;justify-content:center;padding:20px;color:var(--muted);
    }

    .wrap{width:100%;max-width:680px}
    .card{
      background:var(--card); border-radius:16px;padding:24px;border:1px solid var(--border);
      box-shadow:0 12px 40px rgba(0,0,0,0.5); overflow:hidden;
    }

    header{display:flex;align-items:center;gap:16px}
    .logo{
      width:60px;height:60px;border-radius:12px;
      background: linear-gradient(135deg, #ff4500, #ff6347, #ff69b4); /* Gradazioni tramonto/rosso per il cappello del laureato */
      display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:24px;
      flex-shrink:0;
      box-shadow: 0 4px 12px rgba(255, 105, 180, 0.3); /* Ombra leggera per enfatizzare */
    }
    h1{font-size:1.3rem;margin:0;color:var(--text-main)}

    .content-area{
      margin-top:20px;padding:16px;border-radius:12px;
      background:rgba(0,0,0,0.2); border:1px solid var(--border);
      display:flex; align-items:center; gap:16px;
    }
    .main-text{flex:1; line-height:1.5;}
    .song{display:flex; align-items:center; gap:8px; color:var(--accent2); font-weight:600;}
    .song audio{display:block; width:320px; height:40px;} /* Larghezza fissa su desktop per visibilitÃ  */

    .controls{display:flex;gap:12px;margin-top:16px;flex-wrap:wrap}
    .btn{
      flex:1; appearance:none;border:0;padding:12px 16px;border-radius:10px;cursor:pointer;font-weight:600;
      color:white;background:linear-gradient(90deg,var(--accent2),#7b61ff);
      text-align:center;
    }
    .btn.ghost{background:transparent;color:var(--accent2);border:1px solid var(--border);}

    .out{margin-top:16px;min-height:96px;padding:16px;border-radius:12px;
         background:rgba(0,0,0,0.2); border:1px solid var(--border);
         transition: all 0.3s;
    }
    .message{display:flex;align-items:flex-start;gap:12px; animation:fadeIn 0.5s}
    .badge{
      width:44px;height:44px;border-radius:10px;
      background:linear-gradient(135deg, #000011, #220033); /* Colori spaziali scuri attorno alla stella cometa */
      display:flex;align-items:center;justify-content:center;color:#eaf6ff;font-weight:800;font-size:16px;flex-shrink:0;
      box-shadow: 0 0 10px rgba(34, 0, 51, 0.5); /* Ombra spaziale */
    }
    .text{line-height:1.5;color:var(--text-main);white-space:pre-wrap;}

    .stanza{
      font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
      color:var(--text-main);line-height:1.7;white-space:pre-wrap;margin:0; font-size:1rem;
      animation:slideIn 0.6s ease-out;
    }
    .stanza .line{display:block; position:relative; padding-left:24px; }
    .stanza .line:before{content:"â™ª";position:absolute;left:0;color:var(--accent1);opacity:0.8;}

    @keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
    @keyframes slideIn{from{opacity:0;transform:translateX(-12px)}to{opacity:1;transform:translateX(0)}}

    .burst{display:none} /* Rimosso per un look piÃ¹ pulito, ma puoi riattivarlo se vuoi */

    /* --- Mobile Layout --- */
    @media (max-width:600px){
      .card{padding:16px;}
      header{gap:12px;}
      .logo{width:52px;height:52px;}
      h1{font-size:1.2rem;}
      .content-area{
        flex-direction:column; /* Stack verticale */
        align-items:flex-start;
        padding:12px;
      }
      .song{
        width:100%; /* Occupa tutta la larghezza */
        margin-top:12px;
      }
      .song audio{height:48px; width:100%;} /* Player piÃ¹ alto per tocco facile */
      .controls{flex-direction:column;}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="region" aria-label="Auguri per il laureato">
      <header>
        <div class="logo">ðŸŽ“</div>
        <div>
          <h1>Auguri per la tua Laurea, Matteo!</h1>
        </div>
      </header>

      <div class="content-area">
        <div class="main-text">
          Continua a dare il massimo come hai sempre fatto!
        </div>
        <div class="song">
            <audio id="song" controls preload="metadata">
            <source src="Ultimo - Buongiorno Vita (Testo e Audio).mp3" type="audio/mpeg">
            Il tuo browser non supporta l'audio.
          </audio>
        </div>
      </div>

      <div class="controls">
        <button id="show" class="btn" type="button">Mostra il messaggio</button>
        <button id="showAuto" class="btn ghost" type="button">Premi per l'indizio!</button>
      </div>

      <div class="out" id="out" aria-live="polite"></div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const params = new URLSearchParams(location.search);
      const nameParam = params.get('name') ? decodeURIComponent(params.get('name')) : '';

      const audioEl = document.getElementById('song');
      if (params.get('song')) {
        audioEl.querySelector('source').src = decodeURIComponent(params.get('song'));
        audioEl.load(); // Ricarica l'audio con la nuova sorgente
      }

      audioEl.addEventListener('loadedmetadata', () => {
        audioEl.currentTime = 121; // Imposta l'inizio a 2:01
      });

      const baseText = (who) => `Con il regalo che ti abbiamo fatto puoi ascoltare meglio ciÃ² che piÃ¹ ti piace! Buona fortuna per il futuro, il meglio deve ancora venire! ðŸš€`;

      const stanza = `Quando avevo 15 anni, andavo al parco con le cuffie
Adesso ce ne ho 25 e vado al parco con le cuffie
Mi piace ricominciare da dove sono partito
Per essere tale e quale al ricordo di me bambino`;

      const out = document.getElementById('out');

      function showMessage(content, isStanza = false) {
        out.innerHTML = '';
        const p = document.createElement('div');
        if (isStanza) {
          p.className = 'stanza';
          content.split('\n').forEach(line => {
            const lineEl = document.createElement('div');
            lineEl.className = 'line';
            lineEl.textContent = line;
            p.appendChild(lineEl);
          });
        } else {
          p.className = 'message';
          const badge = document.createElement('div');
          badge.className = 'badge';
          badge.textContent = nameParam ? nameParam.trim().charAt(0).toUpperCase() : 'ðŸŒ ';
          const txt = document.createElement('div');
          txt.className = 'text';
          txt.textContent = content;
          p.appendChild(badge);
          p.appendChild(txt);
        }
        out.appendChild(p);
      }

      document.getElementById('show').addEventListener('click', () => showMessage(baseText(nameParam)));
      document.getElementById('showAuto').addEventListener('click', () => showMessage(stanza, true));

      if (params.get('auto') === '1') {
        showMessage(baseText(nameParam));
      }
    });
  </script>
</body>
</html>
